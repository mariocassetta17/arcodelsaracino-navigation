<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Guida al villaggio</title>
</head>
<body>
  <h2>Indicazioni per raggiungere l'appartamento</h2>
  <div id="output">Attivazione GPS in corso...</div>

  <script>
    // Lista dei punti con coordinate e istruzione
    const checkpoints = [
      {lat: 41.1234, lng: 12.1234, msg: "Sei al cancello principale, gira a sinistra."},
      {lat: 41.1240, lng: 12.1240, msg: "Alla rotonda, prendi la seconda uscita."},
      {lat: 41.1250, lng: 12.1250, msg: "Arrivato al palazzo A, l'appartamento è al piano 2."}
    ];

    // Raggio di tolleranza in metri
    const RADIUS = 20;

    let currentStep = 0;

    // Calcola distanza tra due coordinate (formula dell’haversine)
    function distance(lat1, lon1, lat2, lon2) {
      const R = 6371e3; // metri
      const toRad = x => x * Math.PI / 180;
      const φ1 = toRad(lat1), φ2 = toRad(lat2);
      const Δφ = toRad(lat2 - lat1);
      const Δλ = toRad(lon2 - lon1);
      const a = Math.sin(Δφ/2) * Math.sin(Δφ/2) +
                Math.cos(φ1) * Math.cos(φ2) *
                Math.sin(Δλ/2) * Math.sin(Δλ/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

    // Sintesi vocale
    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      speechSynthesis.speak(utter);
    }

    // Monitor GPS
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(pos => {
        const lat = pos.coords.latitude;
        const lng = pos.coords.longitude;
        document.getElementById("output").innerText =
          `Posizione attuale: ${lat.toFixed(5)}, ${lng.toFixed(5)}`;

        if (currentStep < checkpoints.length) {
          const cp = checkpoints[currentStep];
          const dist = distance(lat, lng, cp.lat, cp.lng);

          if (dist < RADIUS) {
            document.getElementById("output").innerText = cp.msg;
            speak(cp.msg);
            currentStep++;
          }
        }
      }, err => {
        document.getElementById("output").innerText = "Errore GPS: " + err.message;
      }, {enableHighAccuracy: true});
    } else {
      document.getElementById("output").innerText = "GPS non supportato.";
    }
  </script>
</body>
</html>

Aggiunto index.html con web app guida villaggio
